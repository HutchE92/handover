(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,66897,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(22016),a=e.i(14677),l=e.i(27639),n=e.i(33234),i=e.i(64486);let d=["FY1","SHO","SpR","Discharge","Nurse"],o=["Scheduled","Ad-hoc"],c=["Medicine","T+O","General Surgery"],x={High:0,Medium:1,Low:2};function m({isOpen:e,reviewDates:s,onClose:r,onCompleteAll:a,onCompleteToday:l}){if(!e)return null;let n=new Date().toISOString().split("T")[0],i=s.find(e=>e.date===n),d=s.filter(e=>e.date>n&&!e.completedAt);return(0,t.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,t.jsxs)("div",{className:"flex min-h-full items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:r}),(0,t.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Complete Review"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"This patient has multiple review dates scheduled. Would you like to:"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("button",{onClick:l,className:"w-full px-4 py-3 bg-purple-100 text-purple-800 rounded-lg text-left hover:bg-purple-200 transition-colors",children:[(0,t.jsx)("div",{className:"font-medium",children:"Complete today's review only"}),(0,t.jsxs)("div",{className:"text-sm text-purple-600",children:[i?`Mark ${new Date(i.date).toLocaleDateString()} as complete`:"Mark current review as complete",d.length>0&&` (${d.length} future review${d.length>1?"s":""} will remain pending)`]})]}),(0,t.jsxs)("button",{onClick:a,className:"w-full px-4 py-3 bg-green-100 text-green-800 rounded-lg text-left hover:bg-green-200 transition-colors",children:[(0,t.jsx)("div",{className:"font-medium",children:"Complete all reviews"}),(0,t.jsxs)("div",{className:"text-sm text-green-600",children:["Mark all ",s.length," scheduled dates as complete"]})]})]}),(0,t.jsx)("button",{onClick:r,className:"mt-4 w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"})]})]})})}function p({isOpen:e,onClose:r,onSubmit:a}){let[l,n]=(0,s.useState)(""),[i,d]=(0,s.useState)(""),[o,c]=(0,s.useState)(null);return e?(0,t.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,t.jsxs)("div",{className:"flex min-h-full items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:r}),(0,t.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Add Comment"}),(0,t.jsx)("div",{className:"text-sm text-gray-500 mb-4",children:new Date().toLocaleString()}),o&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-md text-sm mb-4",children:o}),(0,t.jsxs)("form",{onSubmit:e=>{(e.preventDefault(),l.trim())?i.trim()?(a({text:l.trim(),createdBy:i.trim()}),n(""),d(""),c(null),r()):c("Please enter your name"):c("Please enter a comment")},className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Name *"}),(0,t.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),placeholder:"e.g., Dr. Smith",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comment *"}),(0,t.jsx)("textarea",{value:l,onChange:e=>n(e.target.value),rows:4,placeholder:"Enter your comment...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Add Comment"})]})]})]})]})}):null}function g({isOpen:e,comments:s,onClose:r}){if(!e)return null;let a=[...s].sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());return(0,t.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,t.jsxs)("div",{className:"flex min-h-full items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:r}),(0,t.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[80vh] flex flex-col",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[(0,t.jsxs)("h3",{className:"text-lg font-bold text-gray-900",children:["All Comments (",s.length,")"]}),(0,t.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsx)("div",{className:"p-4 overflow-y-auto flex-1 space-y-3",children:0===a.length?(0,t.jsx)("p",{className:"text-gray-500 text-center py-4",children:"No comments yet"}):a.map(e=>(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900 text-sm",children:e.createdBy}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:new Date(e.createdAt).toLocaleString()})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.text})]},e.id))}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,t.jsx)("button",{onClick:r,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:"Close"})})]})]})})}function h({entry:e,onClose:r,onStatusChange:a,onReassign:l,onAddComment:n}){let[i,d]=(0,s.useState)(!1);return e?(0,t.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,t.jsxs)("div",{className:"flex min-h-full items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:r}),(0,t.jsxs)("div",{className:"relative bg-gray-100 rounded-lg shadow-xl max-w-5xl w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"sticky top-0 bg-red-600 text-white px-4 py-3 rounded-t-lg flex justify-between items-center z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,t.jsx)("span",{className:"font-semibold",children:"High Priority Patient"})]}),(0,t.jsx)("button",{onClick:r,className:"text-white hover:text-red-200",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(b,{entry:e,isExpanded:i,onToggleHandover:()=>d(!i),onStatusChange:a,onReassign:l,onAddComment:t=>n(e.id,t)})})]})]})}):null}function u(){let{patients:e,loading:r}=(0,n.usePatients)(!0),{entries:l,loading:m,refresh:p}=(0,n.useHospitalAtNight)(),[g,u]=(0,s.useState)("dashboard"),[j,y]=(0,s.useState)(null),[v,N]=(0,s.useState)([]),[f,w]=(0,s.useState)([]),[C,k]=(0,s.useState)(""),[S,A]=(0,s.useState)([]),[D,L]=(0,s.useState)([]),[H,R]=(0,s.useState)([]),[B,M]=(0,s.useState)(!1),[P,T]=(0,s.useState)("priority"),[W,$]=(0,s.useState)(new Set),[O,z]=(0,s.useState)(null),I=l.map(t=>({...t,patient:e.find(e=>e.id===t.patientId),latestHandover:i.getLatestHandoverForPatient(t.patientId)})),F=(0,s.useCallback)((e,t,s)=>{let r=I.find(t=>t.id===e);if(!r)return;let a=r.reviewDates,l=t;if("Complete"===t&&s){let e=new Date().toISOString().split("T")[0],t=new Date().toISOString();l=(a=r.reviewDates.map(s=>s.date<=e&&!s.completedAt?{...s,completedAt:t}:s)).some(e=>!e.completedAt)?"Pending":"Complete"}else if("Complete"===t){let e=new Date().toISOString();a=r.reviewDates.map(t=>({...t,completedAt:t.completedAt||e}))}else a=r.reviewDates.map(e=>({...e,completedAt:void 0}));i.updateHospitalAtNightEntry(e,{reviewStatus:l,reviewDates:a,statusChangedAt:"Complete"===l?new Date().toISOString():null}),p()},[I,p]),E=(0,s.useCallback)((e,t)=>{i.updateHospitalAtNightEntry(e,{assignedRoles:t}),p()},[p]),V=(0,s.useCallback)((e,t)=>{let s=I.find(t=>t.id===e);if(!s)return;let r={id:(0,a.v4)(),text:t.text,createdBy:t.createdBy,createdAt:new Date().toISOString()},l=[...s.comments||[],r];i.updateHospitalAtNightEntry(e,{comments:l}),p()},[I,p]),K=[...new Set(I.map(e=>e.patient?.ward).filter(Boolean))].sort((e,t)=>{let s=e.match(/\d+/),r=t.match(/\d+/),a=s?parseInt(s[0],10):NaN,l=r?parseInt(r[0],10):NaN;return isNaN(a)||isNaN(l)?isNaN(a)?isNaN(l)?e.localeCompare(t):1:-1:a-l}),U=I.filter(e=>(!j||e.specialty===j)&&(!(f.length>0)||!!e.assignedRoles.some(e=>f.includes(e)))&&(!C||!!e.reviewDates.some(e=>e.date===C))&&(!(S.length>0)||!!S.includes(e.reviewStatus))&&(!(D.length>0)||!!e.patient?.ward&&!!D.includes(e.patient.ward))&&(!(H.length>0)||!!H.includes(e.reviewType||"Scheduled"))&&!0),Y=[...U].sort((e,t)=>{switch(P){case"priority":return x[e.priority]-x[t.priority];case"oldest":return new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime();case"newest":return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime();default:return 0}}),G=v.length>0?I.filter(e=>v.includes(e.specialty)):I,q={total:G.length,pending:G.filter(e=>"Pending"===e.reviewStatus).length,complete:G.filter(e=>"Complete"===e.reviewStatus).length,byRole:d.reduce((e,t)=>(e[t]=G.filter(e=>e.assignedRoles.includes(t)&&"Pending"===e.reviewStatus).length,e),{})};return r||m?(0,t.jsx)("div",{className:"flex justify-center items-center min-h-[50vh]",children:(0,t.jsx)("div",{className:"text-gray-500",children:"Loading..."})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(h,{entry:O,onClose:()=>z(null),onStatusChange:F,onReassign:E,onAddComment:V}),(0,t.jsx)("div",{className:"flex justify-between items-center",children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-7 h-7 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),"Hospital Out Of Hours"]}),(0,t.jsx)("p",{className:"text-gray-500",children:"Manage out-of-hours patient reviews"})]})}),(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("nav",{className:"flex space-x-8",children:[(0,t.jsx)("button",{onClick:()=>u("dashboard"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${"dashboard"===g?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Dashboard"}),(0,t.jsx)("button",{onClick:()=>u("patients"),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${"patients"===g?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Patients"})]}),"patients"===g&&(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-purple-200 shadow-sm px-5 py-2 text-center",children:[(0,t.jsx)("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Patients for Review"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:U.length})]})]})}),"dashboard"===g&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-500 mr-1",children:"Specialty:"}),c.map(e=>(0,t.jsx)("button",{onClick:()=>{v.includes(e)?N(v.filter(t=>t!==e)):N([...v,e])},className:`px-4 py-2 rounded-lg text-sm font-semibold transition-colors border-2 ${v.includes(e)?"bg-purple-600 text-white border-purple-600 shadow-md":"bg-white text-gray-700 border-gray-300 hover:bg-purple-50 hover:border-purple-300"}`,children:e},e)),v.length>0&&(0,t.jsx)("button",{onClick:()=>N([]),className:"px-3 py-2 text-sm text-purple-600 hover:text-purple-700 font-medium",children:"Show All"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Total Patients"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-gray-900",children:q.total})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Waiting to be Seen"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-amber-600",children:q.pending})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Reviews Complete"}),(0,t.jsx)("div",{className:"text-3xl font-bold text-green-600",children:q.complete})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[(0,t.jsx)("div",{className:"text-sm text-gray-500 mb-1",children:"Completion Rate"}),(0,t.jsxs)("div",{className:"text-3xl font-bold text-purple-600",children:[q.total>0?Math.round(q.complete/q.total*100):0,"%"]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Pending Reviews by Role"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:d.map(e=>(0,t.jsxs)("button",{onClick:()=>{w([e]),A(["Pending"]),u("patients")},className:"bg-purple-50 rounded-lg p-4 text-center border border-purple-100 hover:bg-purple-100 hover:border-purple-300 transition-colors cursor-pointer",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-700",children:q.byRole[e]}),(0,t.jsx)("div",{className:"text-sm text-purple-600",children:e})]},e))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"High Priority Patients"}),0===G.filter(e=>"High"===e.priority&&"Pending"===e.reviewStatus).length?(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:"No high priority patients pending"}):(0,t.jsx)("div",{className:"space-y-2",children:G.filter(e=>"High"===e.priority&&"Pending"===e.reviewStatus).map(e=>(0,t.jsxs)("button",{onClick:()=>z(e),className:"w-full flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-100 hover:bg-red-100 hover:border-red-200 transition-colors cursor-pointer text-left",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:"font-medium text-gray-900",children:[e.patient?.lastName,", ",e.patient?.firstName]}),(0,t.jsxs)("span",{className:"text-sm text-gray-500 ml-2",children:[e.patient?.ward," - Bed ",e.patient?.bedNumber]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded text-xs font-medium",children:"High"}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:e.assignedRoles.join(", ")}),(0,t.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]},e.id))})]})]}),"patients"===g&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[c.map(e=>(0,t.jsx)("button",{onClick:()=>{j===e?y(null):(y(e),w([]),k(""),A([]),L([]),R([]))},className:`px-5 py-2.5 rounded-lg text-sm font-semibold transition-colors border-2 ${j===e?"bg-purple-600 text-white border-purple-600 shadow-md":"bg-white text-gray-700 border-gray-300 hover:bg-purple-50 hover:border-purple-300"}`,children:e},e)),j&&(0,t.jsx)("button",{onClick:()=>y(null),className:"px-3 py-2.5 text-sm text-purple-600 hover:text-purple-700 font-medium",children:"Show All"})]}),(0,t.jsx)("div",{className:"sticky top-0 z-10 py-4 -mt-4 -mx-4 px-4 sm:-mx-6 sm:px-6 lg:-mx-8 lg:px-8",children:(0,t.jsx)("div",{className:"bg-blue-50 rounded-lg shadow border border-blue-200 p-4",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-6 items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Role"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:d.map(e=>(0,t.jsx)("button",{onClick:()=>{f.includes(e)?w(f.filter(t=>t!==e)):w([...f,e])},className:`px-2 py-1.5 rounded text-xs font-medium transition-colors ${f.includes(e)?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Date of Review"}),(0,t.jsx)("input",{type:"date",value:C,onChange:e=>k(e.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-md text-sm bg-white"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Status"}),(0,t.jsx)("div",{className:"flex gap-1",children:["Pending","Complete"].map(e=>(0,t.jsx)("button",{onClick:()=>{S.includes(e)?A(S.filter(t=>t!==e)):A([...S,e])},className:`px-2 py-1.5 rounded text-xs font-medium transition-colors ${S.includes(e)?"Pending"===e?"bg-amber-500 text-white":"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e},e))})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Ward"}),(0,t.jsxs)("button",{onClick:()=>M(!B),className:`px-3 py-1.5 rounded-md text-sm font-medium border transition-colors flex items-center gap-2 ${D.length>0?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:[0===D.length?"All Wards":`${D.length} selected`,(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),B&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>M(!1)}),(0,t.jsxs)("div",{className:"absolute top-full left-0 mt-1 z-20 bg-white rounded-lg shadow-lg border border-gray-200 p-3 min-w-[280px] max-h-[320px] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-2 pb-2 border-b border-gray-100",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Select Wards"}),(0,t.jsx)("button",{onClick:()=>L([]),className:"text-xs text-purple-600 hover:text-purple-700",children:"Clear all"})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-1",children:K.map(e=>(0,t.jsxs)("label",{className:`flex items-center gap-2 px-2 py-1.5 rounded cursor-pointer transition-colors ${D.includes(e)?"bg-blue-50 text-blue-700":"hover:bg-gray-50"}`,children:[(0,t.jsx)("input",{type:"checkbox",checked:D.includes(e),onChange:()=>{D.includes(e)?L(D.filter(t=>t!==e)):L([...D,e])},className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,t.jsx)("span",{className:"text-sm",children:e})]},e))}),(0,t.jsx)("div",{className:"mt-2 pt-2 border-t border-gray-100",children:(0,t.jsx)("button",{onClick:()=>M(!1),className:"w-full px-3 py-1.5 bg-purple-600 text-white rounded-md text-sm font-medium hover:bg-purple-700",children:"Done"})})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Review Type"}),(0,t.jsx)("div",{className:"flex gap-1",children:o.map(e=>(0,t.jsx)("button",{onClick:()=>{H.includes(e)?R(H.filter(t=>t!==e)):R([...H,e])},className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${H.includes(e)?"Scheduled"===e?"bg-blue-100 text-blue-800 border border-blue-300":"bg-orange-100 text-orange-800 border border-orange-300":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:e},e))})]})]}),(f.length>0||C||S.length>0||D.length>0||H.length>0||j)&&(0,t.jsxs)("button",{onClick:()=>{w([]),k(""),A([]),L([]),R([]),y(null)},className:"flex items-center gap-1 px-3 py-1.5 text-sm text-purple-600 hover:text-purple-700 hover:bg-purple-50 rounded-md font-medium transition-colors",title:"Clear all filters",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Clear"]})]})})}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm text-gray-600",children:"Sort by:"}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:()=>T("priority"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${"priority"===P?"bg-purple-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"Priority"}),(0,t.jsx)("button",{onClick:()=>T("oldest"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${"oldest"===P?"bg-purple-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"Oldest First"}),(0,t.jsx)("button",{onClick:()=>T("newest"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${"newest"===P?"bg-purple-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"}`,children:"Newest First"})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:0===Y.length?(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:(0,t.jsx)("p",{className:"text-gray-500",children:"No patients match the current filters"})}):Y.map(e=>(0,t.jsx)(b,{entry:e,isExpanded:W.has(e.id),onToggleHandover:()=>{var t;let s;return t=e.id,void((s=new Set(W)).has(t)?s.delete(t):s.add(t),$(s))},onStatusChange:F,onReassign:E,onAddComment:t=>V(e.id,t)},e.id))})]})]})}function b({entry:e,isExpanded:a,onToggleHandover:n,onStatusChange:i,onReassign:o,onAddComment:c}){let[x,h]=(0,s.useState)(!1),[u,b]=(0,s.useState)(e.assignedRoles),[j,y]=(0,s.useState)(!1),[v,N]=(0,s.useState)(!1),[f,w]=(0,s.useState)(!1),C=e.comments||[],k=[...C].sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(0,3),S=C.length-3,A=e.reviewDates.length>1,D=e.reviewDates.some(e=>!e.completedAt&&e.date>new Date().toISOString().split("T")[0]),L=t=>{"Complete"===t&&A&&D?y(!0):i(e.id,t)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m,{isOpen:j,reviewDates:e.reviewDates,onClose:()=>y(!1),onCompleteAll:()=>{i(e.id,"Complete"),y(!1)},onCompleteToday:()=>{i(e.id,"Complete",!0),y(!1)}}),(0,t.jsx)(p,{isOpen:v,onClose:()=>N(!1),onSubmit:c}),(0,t.jsx)(g,{isOpen:f,comments:C,onClose:()=>w(!1)}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 overflow-hidden",children:[(0,t.jsxs)("div",{className:"bg-purple-50 border-b border-purple-100 px-4 py-2 flex flex-wrap items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-4 h-4 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,t.jsx)("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${"Ad-hoc"===e.reviewType?"bg-orange-100 text-orange-800 border border-orange-200":"bg-blue-100 text-blue-800 border border-blue-200"}`,children:e.reviewType||"Scheduled"}),(0,t.jsx)("span",{className:"text-sm font-medium text-purple-700",children:"Review Date(s):"}),e.reviewDates.map((e,s)=>(0,t.jsxs)("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${e.completedAt?"bg-green-100 text-green-700 border border-green-200":"bg-purple-100 text-purple-800 border border-purple-200"}`,children:[new Date(e.date).toLocaleDateString(),e.completedAt&&" âœ“"]},s))]}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsxs)(r.default,{href:`/patients/${e.patientId}`,className:"font-bold text-gray-900 text-lg hover:text-purple-600 hover:underline transition-colors",children:[e.patient?.lastName,", ",e.patient?.firstName]}),(0,t.jsx)("span",{className:`px-3 py-1 rounded-md text-sm font-bold border-2 shadow-sm ${{High:"bg-red-500 text-white border-red-600",Medium:"bg-amber-500 text-white border-amber-600",Low:"bg-green-500 text-white border-green-600"}[e.priority]}`,children:e.priority})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-2 text-sm text-gray-600 mb-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Ward:"})," ",e.patient?.ward]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Bed:"})," ",e.patient?.bedNumber]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"NHS:"})," ",e.patient?(0,l.formatNhsNumber)(e.patient.nhsNumber):"-"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Age:"})," ",e.patient?(0,l.calculateAge)(e.patient.dateOfBirth):"-"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"NEWS:"})," ",e.patient?.earlyWarningScore!==null&&e.patient?.earlyWarningScore!==void 0?(0,t.jsx)("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${(0,l.getNewsScoreColor)(e.patient.earlyWarningScore)}`,children:e.patient.earlyWarningScore}):(0,t.jsx)("span",{className:"text-gray-400",children:"-"})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Specialty:"})," ",(0,t.jsx)("span",{className:"font-medium",children:e.specialty})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400",children:"Assigned to:"})," ",(0,t.jsx)("span",{className:"font-medium",children:e.assignedRoles.join(", ")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-gray-400 text-sm",children:"Reason:"}),(0,t.jsx)("p",{className:"text-gray-700 mt-1",children:e.reasonForReview})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-400",children:["Added by ",e.createdBy," on ",new Date(e.createdAt).toLocaleString()]})]}),(0,t.jsx)("button",{onClick:n,className:"mt-3 flex items-center gap-1 text-sm text-purple-600 hover:text-purple-700 font-medium",children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Hide Handover"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Show Handover"]})})]}),(0,t.jsxs)("div",{className:"w-56 border-l border-gray-200 pl-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase",children:"Comments"}),C.length>0&&(0,t.jsxs)("button",{onClick:()=>w(!0),className:"flex items-center gap-1 text-xs text-purple-600 hover:text-purple-700",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),C.length,S>0&&(0,t.jsxs)("span",{className:"text-gray-400",children:["(+",S," more)"]})]})]}),(0,t.jsx)("div",{className:"space-y-2 mb-3 max-h-40 overflow-y-auto",children:0===k.length?(0,t.jsx)("p",{className:"text-xs text-gray-400 italic",children:"No comments yet"}):k.map(e=>(0,t.jsxs)("div",{className:"bg-gray-50 rounded p-2 text-xs border border-gray-100",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start gap-2 mb-1",children:[(0,t.jsx)("span",{className:"font-medium text-gray-700 truncate",children:e.createdBy}),(0,t.jsx)("span",{className:"text-gray-400 whitespace-nowrap",children:new Date(e.createdAt).toLocaleDateString()})]}),(0,t.jsx)("p",{className:"text-gray-600 line-clamp-2",children:e.text})]},e.id))}),(0,t.jsxs)("button",{onClick:()=>N(!0),className:"w-full px-3 py-1.5 bg-purple-50 text-purple-700 border border-purple-200 rounded-md text-xs font-medium hover:bg-purple-100 transition-colors flex items-center justify-center gap-1",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Comment"]})]}),(0,t.jsxs)("div",{className:"w-48 border-l border-gray-200 pl-4",children:[(0,t.jsx)("h4",{className:"text-xs font-medium text-gray-500 uppercase mb-2",children:"Outcome"}),(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)("label",{className:"text-xs text-gray-400",children:"Review Status"}),e.reviewDates.some(e=>e.completedAt)&&e.reviewDates.some(e=>!e.completedAt)?(0,t.jsxs)("div",{className:"mt-1 space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"px-2 py-1 bg-green-50 border border-green-300 text-green-700 rounded text-xs font-medium",children:"Complete"}),(0,t.jsx)("span",{className:"text-gray-400",children:"&"}),(0,t.jsx)("span",{className:"px-2 py-1 bg-amber-50 border border-amber-300 text-amber-700 rounded text-xs font-medium",children:"Pending"})]}),(0,t.jsx)("button",{onClick:()=>L("Complete"),className:"w-full mt-1 px-2 py-1 bg-green-100 text-green-700 rounded text-xs hover:bg-green-200",children:"Complete remaining"})]}):(0,t.jsxs)("select",{value:e.reviewStatus,onChange:e=>L(e.target.value),className:`w-full mt-1 px-2 py-1.5 rounded-md border text-sm font-medium ${"Complete"===e.reviewStatus?"bg-green-50 border-green-300 text-green-700":"bg-amber-50 border-amber-300 text-amber-700"}`,children:[(0,t.jsx)("option",{value:"Pending",children:"Pending"}),(0,t.jsx)("option",{value:"Complete",children:"Complete"})]}),e.statusChangedAt&&"Complete"===e.reviewStatus&&(0,t.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["Completed: ",new Date(e.statusChangedAt).toLocaleString()]})]}),(0,t.jsx)("div",{children:x?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:d.map(e=>(0,t.jsx)("button",{onClick:()=>{u.includes(e)?b(u.filter(t=>t!==e)):b([...u,e])},className:`px-2 py-0.5 rounded text-xs font-medium transition-colors ${u.includes(e)?"bg-purple-600 text-white":"bg-gray-100 text-gray-600"}`,children:e},e))}),(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)("button",{onClick:()=>{o(e.id,u),h(!1)},className:"flex-1 px-2 py-1 bg-purple-600 text-white rounded text-xs font-medium hover:bg-purple-700",children:"Save"}),(0,t.jsx)("button",{onClick:()=>{b(e.assignedRoles),h(!1)},className:"px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs font-medium hover:bg-gray-300",children:"Cancel"})]})]}):(0,t.jsx)("button",{onClick:()=>h(!0),className:"w-full px-3 py-1.5 bg-gray-100 text-gray-700 rounded-md text-sm font-medium hover:bg-gray-200 transition-colors",children:"Reassign"})})]})]})}),a&&e.latestHandover&&(0,t.jsxs)("div",{className:"border-t border-gray-200 bg-gray-50 p-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Latest Handover"}),(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"bg-blue-100 text-blue-800 w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold",children:"S"}),(0,t.jsx)("span",{className:"text-xs font-semibold text-blue-700",children:"Situation"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.latestHandover.situation})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"bg-green-100 text-green-800 w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold",children:"B"}),(0,t.jsx)("span",{className:"text-xs font-semibold text-green-700",children:"Background"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.latestHandover.background})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"bg-amber-100 text-amber-800 w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold",children:"A"}),(0,t.jsx)("span",{className:"text-xs font-semibold text-amber-700",children:"Assessment"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.latestHandover.assessment})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"bg-red-100 text-red-800 w-5 h-5 rounded-full flex items-center justify-center text-xs font-bold",children:"R"}),(0,t.jsx)("span",{className:"text-xs font-semibold text-red-700",children:"Recommendation"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.latestHandover.recommendation})]})]}),(0,t.jsxs)("p",{className:"text-xs text-gray-400 mt-2",children:["By ",e.latestHandover.createdBy," on ",new Date(e.latestHandover.createdAt).toLocaleDateString()]})]}),a&&!e.latestHandover&&(0,t.jsx)("div",{className:"border-t border-gray-200 bg-gray-50 p-4",children:(0,t.jsx)("p",{className:"text-sm text-gray-500 italic",children:"No handover notes available for this patient"})})]})]})}e.s(["default",()=>u])}]);