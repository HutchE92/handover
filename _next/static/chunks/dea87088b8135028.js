(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,56978,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(22016),a=e.i(27639);let l=["High","Medium","Low"],i=["FY1","SHO","SpR","Discharge","Nurse"],n=["Scheduled","Ad-hoc"],d=["Medicine","T+O","General Surgery"];function o({patient:e,isOpen:s,onClose:a,onSubmit:o}){let[c,x]=(0,r.useState)([{date:new Date().toISOString().split("T")[0]}]),[m,u]=(0,r.useState)(""),[h,g]=(0,r.useState)([]),[p,b]=(0,r.useState)(""),[v,f]=(0,r.useState)(""),[y,j]=(0,r.useState)(""),[N,w]=(0,r.useState)("Scheduled"),[S,k]=(0,r.useState)(null),[C,A]=(0,r.useState)(!1);if(!s)return null;let D=async e=>{if(e.preventDefault(),k(null),!m)return void k("Please select a priority");if(0===h.length)return void k("Please select at least one role");if(!p.trim())return void k("Please provide a reason for review");if(!v.trim())return void k("Please enter your name");if(!y)return void k("Please select a specialty");let t=c.filter(e=>e.date);if(0===t.length)return void k("Please add at least one review date");A(!0);try{await o({reviewDates:t,priority:m,assignedRoles:h,reasonForReview:p,createdBy:v,reviewType:N,specialty:y}),x([{date:new Date().toISOString().split("T")[0]}]),u(""),g([]),b(""),w("Scheduled"),j(""),a()}catch{k("Failed to submit. Please try again.")}finally{A(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,t.jsxs)("div",{className:"flex min-h-full items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:a}),(0,t.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"bg-purple-600 text-white px-6 py-4 rounded-t-lg",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-lg font-bold",children:"Hospital Out Of Hours"}),(0,t.jsx)("button",{onClick:a,className:"text-white hover:text-purple-200",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("p",{className:"text-purple-100 text-sm mt-1",children:[e.lastName,", ",e.firstName," - ",e.ward,", Bed ",e.bedNumber]})]}),(0,t.jsxs)("form",{onSubmit:D,className:"p-6 space-y-5",children:[S&&(0,t.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm",children:S}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Name *"}),(0,t.jsx)("input",{type:"text",value:v,onChange:e=>f(e.target.value),placeholder:"e.g., Nurse Smith",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Specialty *"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:d.map(e=>(0,t.jsxs)("label",{className:`flex items-center gap-2 px-4 py-2 rounded-md border cursor-pointer transition-colors ${y===e?"bg-purple-100 border-purple-400 text-purple-800":"bg-gray-50 border-gray-300 hover:bg-gray-100"}`,children:[(0,t.jsx)("input",{type:"radio",name:"specialty",value:e,checked:y===e,onChange:()=>j(e),className:"sr-only"}),e]},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Review *"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:n.map(e=>(0,t.jsxs)("label",{className:`flex items-center gap-2 px-4 py-2 rounded-md border cursor-pointer transition-colors ${N===e?"Scheduled"===e?"bg-blue-100 border-blue-400 text-blue-800":"bg-orange-100 border-orange-400 text-orange-800":"bg-gray-50 border-gray-300 hover:bg-gray-100"}`,children:[(0,t.jsx)("input",{type:"radio",name:"reviewType",value:e,checked:N===e,onChange:()=>{w(e),"Ad-hoc"===e&&x([{date:new Date().toISOString().split("T")[0]}])},className:"sr-only"}),e]},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date(s) to be Reviewed *"}),(0,t.jsx)("div",{className:"space-y-2",children:c.map((e,r)=>(0,t.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,t.jsx)("input",{type:"date",value:e.date,onChange:e=>{var t;let s;return t=e.target.value,void((s=[...c])[r]={...s[r],date:t},x(s))},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500"}),c.length>1&&(0,t.jsx)("button",{type:"button",onClick:()=>{c.length>1&&x(c.filter((e,t)=>t!==r))},className:"p-2 text-red-500 hover:text-red-700",children:(0,t.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},r))}),(0,t.jsx)("button",{type:"button",onClick:()=>{x([...c,{date:""}])},className:"mt-2 text-sm text-purple-600 hover:text-purple-700 font-medium",children:"+ Add another date"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority *"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:l.map(e=>(0,t.jsxs)("label",{className:`flex items-center gap-2 px-4 py-2 rounded-md border cursor-pointer transition-colors ${m===e?"High"===e?"bg-red-100 border-red-400 text-red-800":"Medium"===e?"bg-amber-100 border-amber-400 text-amber-800":"Low"===e?"bg-green-100 border-green-400 text-green-800":"bg-blue-100 border-blue-400 text-blue-800":"bg-gray-50 border-gray-300 hover:bg-gray-100"}`,children:[(0,t.jsx)("input",{type:"radio",name:"priority",value:e,checked:m===e,onChange:()=>u(e),className:"sr-only"}),e]},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To be Reviewed By *"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:i.map(e=>(0,t.jsxs)("label",{className:`flex items-center gap-2 px-4 py-2 rounded-md border cursor-pointer transition-colors ${h.includes(e)?"bg-purple-100 border-purple-400 text-purple-800":"bg-gray-50 border-gray-300 hover:bg-gray-100"}`,children:[(0,t.jsx)("input",{type:"checkbox",checked:h.includes(e),onChange:()=>{h.includes(e)?g(h.filter(t=>t!==e)):g([...h,e])},className:"sr-only"}),e]},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason for Review *"}),(0,t.jsx)("textarea",{value:p,onChange:e=>b(e.target.value),rows:4,placeholder:"Describe the reason for review and any specific concerns...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,t.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:C,className:"px-6 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:C?"Submitting...":"Submit"})]})]})]})]})})}var c=e.i(14677),x=e.i(33234),m=e.i(64486);let u=Array.from({length:20},(e,t)=>`Ward ${t+1}`);function h({entry:e,patient:s,isOpen:l,onClose:i,onStatusChange:n,onAddComment:d}){let[o,x]=(0,r.useState)(""),[m,u]=(0,r.useState)("");return l?(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center sticky top-0 bg-white",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"OOH Review Details"}),(0,t.jsx)("button",{onClick:i,className:"text-gray-500 hover:text-gray-700",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[s&&(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,t.jsxs)("div",{className:"font-bold text-gray-900",children:[s.lastName,", ",s.firstName]}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:[s.ward," - Bed ",s.bedNumber," | NHS: ",(0,a.formatNhsNumber)(s.nhsNumber)]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${(e=>{switch(e){case"High":return"bg-red-100 text-red-800 border-red-300";case"Medium":return"bg-amber-100 text-amber-800 border-amber-300";case"Low":return"bg-green-100 text-green-800 border-green-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}})(e.priority)}`,children:[e.priority," Priority"]}),(0,t.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${"Pending"===e.reviewStatus?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-green-100 text-green-800 border border-green-300"}`,children:e.reviewStatus})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Specialty"}),(0,t.jsx)("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-800 rounded text-xs font-medium",children:e.specialty})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.assignedRoles.map(e=>(0,t.jsx)("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-800 rounded text-xs font-medium",children:e},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Review Dates"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:e.reviewDates.map((e,r)=>(0,t.jsxs)("span",{className:`px-2 py-1 rounded text-xs font-medium ${e.completedAt?"bg-green-100 text-green-800":"bg-gray-100 text-gray-700"}`,children:[new Date(e.date).toLocaleDateString(),e.completedAt&&" ✓"]},r))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Reason for Review"}),(0,t.jsx)("p",{className:"text-sm text-gray-800 bg-gray-50 p-3 rounded-lg",children:e.reasonForReview})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:["Comments (",e.comments?.length||0,")"]}),e.comments&&e.comments.length>0?(0,t.jsx)("div",{className:"space-y-2 mb-3",children:e.comments.slice().sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).map(e=>(0,t.jsxs)("div",{className:"bg-gray-50 p-2 rounded text-sm",children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:[new Date(e.createdAt).toLocaleString()," - ",e.createdBy]}),(0,t.jsx)("div",{className:"text-gray-800",children:e.text})]},e.id))}):(0,t.jsx)("p",{className:"text-sm text-gray-500 mb-3",children:"No comments yet"}),(0,t.jsxs)("div",{className:"space-y-2 border-t pt-3",children:[(0,t.jsx)("input",{type:"text",value:m,onChange:e=>u(e.target.value),placeholder:"Your name",className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,t.jsx)("textarea",{value:o,onChange:e=>x(e.target.value),placeholder:"Add a comment...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,t.jsx)("button",{onClick:()=>{if(!o.trim()||!m.trim())return;let t={id:(0,c.v4)(),text:o.trim(),createdBy:m.trim(),createdAt:new Date().toISOString()};d(e.id,t),x(""),u("")},disabled:!o.trim()||!m.trim(),className:"px-3 py-1.5 bg-blue-600 text-white rounded text-sm font-medium hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Add Comment"})]})]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 border-t pt-3",children:["Created by ",e.createdBy," on ",new Date(e.createdAt).toLocaleString()]}),(0,t.jsxs)("div",{className:"flex gap-2 pt-2 border-t",children:["Pending"===e.reviewStatus?(0,t.jsx)("button",{onClick:()=>n(e.id,"Complete"),className:"px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700",children:"Mark Complete"}):(0,t.jsx)("button",{onClick:()=>n(e.id,"Pending"),className:"px-4 py-2 bg-yellow-600 text-white rounded-md text-sm font-medium hover:bg-yellow-700",children:"Reopen Review"}),(0,t.jsx)("button",{onClick:i,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md text-sm font-medium hover:bg-gray-300",children:"Close"})]})]})]})}):null}function g(){let{patients:e,loading:l}=(0,x.usePatients)(!0),{notes:i,loading:n}=(0,x.useHandoverNotes)(),{entries:d,loading:g,refresh:p}=(0,x.useHospitalAtNight)(),[b,v]=(0,r.useState)(""),[f,y]=(0,r.useState)(""),[j,N]=(0,r.useState)(!1),[w,S]=(0,r.useState)(null),[k,C]=(0,r.useState)(null),A=async e=>{if(!w)return;let t={id:(0,c.v4)(),patientId:w.id,reviewDates:e.reviewDates,priority:e.priority,assignedRoles:e.assignedRoles,reasonForReview:e.reasonForReview,reviewStatus:"Pending",reviewType:e.reviewType,specialty:e.specialty,statusChangedAt:null,createdAt:new Date().toISOString(),createdBy:e.createdBy,comments:[]};m.createHospitalAtNightEntry(t),S(null),p()},D=e=>d.find(t=>t.patientId===e&&"Pending"===t.reviewStatus);(0,r.useEffect)(()=>{let e=localStorage.getItem("defaultWard");e&&(y(e),v(e))},[]);let H=i.map(t=>({...t,patient:e.find(e=>e.id===t.patientId)})),B=e.filter(e=>e.ward===b&&e.isActive).map(e=>{let t=H.filter(t=>t.patientId===e.id).sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime());return{...e,latestHandover:t[0]}}).sort((e,t)=>e.bedNumber.localeCompare(t.bedNumber,void 0,{numeric:!0})),L=28-B.length,R=B.filter(e=>null!==e.earlyWarningScore&&e.earlyWarningScore>=5).length,W=j?B.filter(e=>null!==e.earlyWarningScore&&e.earlyWarningScore>=5):B;return l||n||g?(0,t.jsx)("div",{className:"flex justify-center items-center min-h-[50vh]",children:(0,t.jsx)("div",{className:"text-gray-500",children:"Loading handovers..."})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center print:hidden",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Ward Handover"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Select a ward to view patient handover information"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:"Default Ward:"}),(0,t.jsxs)("select",{value:f,onChange:e=>{var t;y(t=e.target.value),t?(localStorage.setItem("defaultWard",t),v(t)):localStorage.removeItem("defaultWard")},className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,t.jsx)("option",{value:"",children:"None"}),u.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-4 print:hidden",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Ward"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:u.map(e=>(0,t.jsx)("button",{onClick:()=>{v(e),N(!1)},className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${b===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.replace("Ward ","")},e))})]}),b?0===B.length?(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[(0,t.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["No patients in ",b]}),(0,t.jsx)("p",{className:"text-gray-500 mb-4",children:"There are no active patients assigned to this ward"}),(0,t.jsx)(s.default,{href:"/patients/new",className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-md font-medium hover:bg-blue-700 transition-colors",children:"+ Add New Patient"})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"bg-blue-600 text-white rounded-lg p-4 print:bg-white print:text-black print:border print:border-gray-300",children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:b}),(0,t.jsxs)("p",{className:"text-sm text-blue-100 print:text-gray-500 hidden print:block",children:["Printed: ",new Date().toLocaleDateString("en-GB",{weekday:"long",day:"numeric",month:"long",year:"numeric"})," at ",new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:B.length}),(0,t.jsx)("div",{className:"text-xs text-blue-100 print:text-gray-500",children:"Patients"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:L}),(0,t.jsx)("div",{className:"text-xs text-blue-100 print:text-gray-500",children:"Empty Beds"})]}),(0,t.jsxs)("button",{onClick:()=>R>0&&N(!j),disabled:0===R,className:`text-center px-3 py-2 rounded-lg transition-colors ${R>0?j?"bg-red-700 border-2 border-white cursor-pointer":"bg-red-600 border-2 border-red-400 cursor-pointer hover:bg-red-700":""}`,children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:R}),(0,t.jsx)("div",{className:"text-xs text-white",children:"High NEWS"})]}),(0,t.jsx)("button",{onClick:()=>window.print(),className:"ml-4 px-4 py-2 bg-white text-blue-600 rounded-md text-sm font-medium hover:bg-blue-50 transition-colors print:hidden",children:"Print Ward List"})]})]})}),j&&(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-red-700 font-medium",children:["Showing ",W.length," patient",1!==W.length?"s":""," with high NEWS score (5+)"]}),(0,t.jsx)("button",{onClick:()=>N(!1),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Show all patients"})]}),(0,t.jsx)("div",{className:"space-y-3 print:space-y-2",children:W.map(e=>(0,t.jsx)("div",{className:"bg-white rounded-lg shadow border border-gray-200 overflow-hidden print:break-inside-avoid print:shadow-none",children:(0,t.jsxs)("div",{className:"grid grid-cols-5 divide-x divide-gray-200",children:[(0,t.jsx)("div",{className:"p-3 bg-gray-50",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{children:(0,t.jsxs)(s.default,{href:`/patients/${e.id}`,className:"font-bold text-gray-900 hover:text-blue-600 text-lg",children:[e.lastName,", ",e.firstName]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Bed"}),(0,t.jsx)("div",{className:"font-medium text-blue-600",children:e.bedNumber})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"NHS"}),(0,t.jsx)("div",{className:"text-sm",children:(0,a.formatNhsNumber)(e.nhsNumber)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Age"}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,a.calculateAge)(e.dateOfBirth)," (",new Date(e.dateOfBirth).toLocaleDateString(),")"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Diagnosis"}),(0,t.jsx)("div",{className:"text-sm",children:e.diagnosis})]}),e.allergies&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Allergies"}),(0,t.jsx)("div",{className:"text-sm text-red-600 font-medium",children:e.allergies})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1 pt-1",children:[(0,t.jsx)("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${(0,a.getResusStatusColor)(e.resuscitationStatus)}`,children:e.resuscitationStatus}),null!==e.earlyWarningScore&&(0,t.jsxs)("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${(0,a.getNewsScoreColor)(e.earlyWarningScore)}`,children:["NEWS: ",e.earlyWarningScore]})]}),D(e.id)&&(0,t.jsxs)("button",{onClick:()=>C(D(e.id)),className:"mt-2 flex items-center gap-1 px-2 py-1 bg-purple-100 text-purple-800 border border-purple-300 rounded text-xs font-medium hover:bg-purple-200 transition-colors print:hidden",children:[(0,t.jsx)("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),"Active OOH Review"]}),(0,t.jsxs)("div",{className:"pt-2 flex gap-2 print:hidden",children:[(0,t.jsx)(s.default,{href:`/handover/new/${e.id}`,className:"inline-block px-3 py-1 bg-blue-600 text-white rounded text-xs font-medium hover:bg-blue-700",children:"+ Handover"}),(0,t.jsx)(s.default,{href:`/patients/${e.id}#handover-history`,className:"inline-block px-3 py-1 bg-gray-200 text-gray-700 rounded text-xs font-medium hover:bg-gray-300",children:"History"})]})]})}),e.latestHandover?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(s.default,{href:`/handover/new/${e.id}`,className:"p-3 hover:bg-blue-50 cursor-pointer transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"bg-blue-100 text-blue-800 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",children:"S"}),(0,t.jsx)("span",{className:"text-xs font-semibold text-blue-700",children:"Situation"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.latestHandover.situation})]}),(0,t.jsxs)(s.default,{href:`/handover/new/${e.id}`,className:"p-3 hover:bg-green-50 cursor-pointer transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"bg-green-100 text-green-800 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",children:"B"}),(0,t.jsx)("span",{className:"text-xs font-semibold text-green-700",children:"Background"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.latestHandover.background})]}),(0,t.jsxs)(s.default,{href:`/handover/new/${e.id}`,className:"p-3 hover:bg-amber-50 cursor-pointer transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"bg-amber-100 text-amber-800 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",children:"A"}),(0,t.jsx)("span",{className:"text-xs font-semibold text-amber-700",children:"Assessment"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.latestHandover.assessment})]}),(0,t.jsxs)("div",{className:"p-3 flex flex-col",children:[(0,t.jsxs)(s.default,{href:`/handover/new/${e.id}`,className:"hover:bg-red-50 cursor-pointer transition-colors flex-1 -m-3 p-3 mb-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"bg-red-100 text-red-800 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",children:"R"}),(0,t.jsx)("span",{className:"text-xs font-semibold text-red-700",children:"Recommendation"})]}),(0,t.jsx)("p",{className:"text-sm text-gray-700",children:e.latestHandover.recommendation})]}),(0,t.jsxs)("div",{className:"mt-3 p-2 bg-gray-100 rounded border border-gray-200",children:[(0,t.jsx)("div",{className:"text-xs text-gray-600 font-medium",children:e.latestHandover.createdBy}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:[e.latestHandover.shiftType," • ",new Date(e.latestHandover.shiftDate).toLocaleDateString()]})]}),(0,t.jsxs)("button",{onClick:t=>{t.preventDefault(),S(e)},className:"mt-2 flex items-center justify-center gap-1 px-3 py-1.5 bg-purple-100 text-purple-700 rounded border border-purple-300 text-xs font-medium hover:bg-purple-200 transition-colors",children:[(0,t.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),"Refer to OOH"]})]})]}):(0,t.jsxs)("div",{className:"col-span-4 p-4 flex items-center justify-center text-gray-500 text-sm",children:["No handover notes yet."," ",(0,t.jsx)(s.default,{href:`/handover/new/${e.id}`,className:"text-blue-600 hover:text-blue-700 font-medium ml-1",children:"Create one now"})]})]})},e.id))})]}):(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a ward to begin"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Choose a ward number above to view patients and their handover information"})]}),w&&(0,t.jsx)(o,{patient:w,isOpen:!0,onClose:()=>S(null),onSubmit:A}),k&&(0,t.jsx)(h,{entry:k,patient:e.find(e=>e.id===k.patientId),isOpen:!0,onClose:()=>C(null),onStatusChange:(e,t)=>{if(m.updateHospitalAtNightEntry(e,{reviewStatus:t,statusChangedAt:new Date().toISOString()}),p(),k?.id===e){let t=m.getHospitalAtNightById(e);t&&C(t)}},onAddComment:(e,t)=>{let r=d.find(t=>t.id===e);if(!r)return;let s=[...r.comments||[],t];if(m.updateHospitalAtNightEntry(e,{comments:s}),p(),k?.id===e){let t=m.getHospitalAtNightById(e);t&&C(t)}}})]})}e.s(["default",()=>g],56978)}]);